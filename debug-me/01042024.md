# Script and Workflow for Excel Automation

## Key Requirements
The script will:
1. Loop through all worksheets in an Excel workbook and extract data from:
   - Specific cells (`G20`, `H20`, `I20`).
   - Optionally apply additional logic, such as filtering rows based on specific conditions.
2. Store the results in a new worksheet named `total-calculated-data`.
   - Include columns: `Sheet Name`, `G20`, `H20`, `I20`, and optionally logic-based flags or summaries.
   - Clear and update the output worksheet every time the script runs.

---

## Step-by-Step Approach

### Initial Goals
1. Create a script to:
   - Loop through worksheets.
   - Extract data from specific cells (`G20`, `H20`, `I20`).
   - Write the extracted data to an output worksheet.
2. Test functionality for edge cases (e.g., empty sheets or missing data).
3. Prepare for future enhancements, such as logic-based filtering.

---

## Prototype Script

```typescript
function main(workbook: ExcelScript.Workbook) {
  // Define the output sheet name
  const outputSheetName = "total-calculated-data";

  // Try to access the output sheet, if it exists; otherwise, create it
  let outputSheet = workbook.getWorksheet(outputSheetName);
  if (!outputSheet) {
    outputSheet = workbook.addWorksheet(outputSheetName);
  }

  // Clear the output sheet before writing new data
  outputSheet.getUsedRange()?.clear();

  // Initialize the result data with a header row
  let resultData: (string | number | boolean)[][] = [
    ["Sheet Name", "G20", "H20", "I20"]
  ];

  // Loop through all worksheets in the workbook
  const sheets = workbook.getWorksheets();
  sheets.forEach(sheet => {
    const sheetName = sheet.getName();

    // Skip the output sheet itself to avoid recursion
    if (sheetName === outputSheetName) {
      return;
    }

    try {
      // Extract data from cells G20, H20, and I20 in the current sheet
      const g20 = sheet.getRange("G20").getValue() || ""; // Default to empty if no value
      const h20 = sheet.getRange("H20").getValue() || "";
      const i20 = sheet.getRange("I20").getValue() || "";

      // Add the extracted data to the resultData array
      resultData.push([sheetName, g20, h20, i20]);
    } catch (error) {
      console.error(`Error reading data from sheet "${sheetName}": ${error}`);
    }
  });

  // Write the collected data to the output sheet
  outputSheet.getRange(0, 0, resultData.length, resultData[0].length).setValues(resultData);

  // Autofit columns in the output sheet for readability
  outputSheet.getUsedRange()?.getFormat().autofitColumns();
}
```
## Jason Review final Steps in personal account.
